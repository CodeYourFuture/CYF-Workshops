<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Team Randomiser</title>
    <link rel="stylesheet" href="assets/styles.css" />
    <script src="assets/app.js" defer></script>
  </head>
  <body>
    <a class="is-invisible" href="#main">Skip to main</a>
    <header class="header">
      <h1 class="header__heading">
        <a
          class="header__link"
          href="https://github.com/CodeYourFuture/CYF-Workshops/tree/main/components-1"
        >
          <span class="is-invisible">Code Your Future</span>
          <svg
            class="header__logo"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 512 512"
            focusable="false"
          >
            <path
              fill="currentcolor"
              stroke="currentcolor"
              d="M225.5 1c-1.1.5-3.5.9-5.3.9-4.1.1-22.9 4.5-30.7 7.2-63.1 22-114.7 72.3-142.7 139.4-6.4 15.2-11.8 33.8-16.7 57-4.1 19.7-5.4 64.5-2.6 90.8C33 346.2 49.8 390.1 76.8 425c6.2 7.9 23.9 26.4 30.7 32 8.1 6.7 26.1 18.7 35.1 23.6 28.1 15.1 58 24.3 91.9 28.3 5.5.7 13.6 1.7 18 2.2 8.8 1.2 33.9.7 48-.9 11-1.3 31.7-4.8 36.5-6.2 1.9-.5 8-2.3 13.5-3.9 21.3-6.1 47.2-17.8 67.5-30.5 8.8-5.4 23.7-15.8 28.5-19.7 10.2-8.4 24.5-21.3 31.4-28.2l8.4-8.5-2.2-2.9c-1.3-1.5-4.6-5.3-7.4-8.3-6.2-6.7-14.5-15.7-21.2-23.1-2.7-3-7.5-8.2-10.5-11.4-3-3.3-9.8-10.8-15.1-16.5-21.5-23.6-24.2-26.5-24.9-26.8-.3-.1-2 1.2-3.6 3-1.6 1.9-6.3 7.1-10.4 11.7-8.6 9.7-25.6 24.6-35.9 31.4-21.4 14.4-42.5 21.7-62.6 21.7-15.3-.1-29.3-3.3-42.5-10-22.8-11.5-41.9-35.5-51.5-64.7-4.2-12.8-4.3-13.4-5.9-22.8-3.8-22.9-4.6-39.2-2.6-55.6 2.7-22.7 3.3-26.5 5-33.2 7.9-30.9 16.7-48.6 32.4-65.6 16.8-17.9 41.1-24.9 65.1-18.6 30 7.8 50.7 36.3 55.5 76.3.5 4.6 1.2 8.7 1.5 9.3.4.5 25.1.9 62.6.9H474V9H364.2L357 26.7c-4 9.8-7.9 18.5-8.7 19.3-1.3 1.3-2.1.8-6.6-4.3-6-6.9-18.3-16.7-28.2-22.5-7.4-4.3-22.6-10.9-28.5-12.4-9.2-2.2-18.1-4.1-24-5-9-1.3-33.1-1.9-35.5-.8z"
            />
          </svg>
        </a>
      </h1>
      <h2 class="header__page">Team Generator</h2>
      <button id="toggle" class="header__action">
        <span class="is-invisible">Toggle Menu.</span>
        <svg
          class="header__dots"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <path
            stroke="currentcolor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M13 5a1 1 0 1 0-2 0 1 1 0 0 0 2 0Zm0 7a1 1 0 1 0-2 0 1 1 0 0 0 2 0Zm0 7a1 1 0 1 0-2 0 1 1 0 0 0 2 0Z"
          />
        </svg>
      </button>
    </header>
    <nav class="menu" id="menu" hidden>
      <ul>
        <li>
          <a href="index.html">Components Workshop</a>
        </li>
        <li>
          <a href="teams.html">Team Generator</a>
        </li>
        <li>
          <a href="docs/card/">Card docs</a>
        </li>
        <li>
          <a href="docs/header">Header docs</a>
        </li>
        <li>
          <a href="docs/footer">Footer docs</a>
        </li>
      </ul>
    </nav>
    <main tabindex="0" id="main" class="main">
      <team-randomiser></team-randomiser>
    </main>
    <footer class="footer">
      <a
        class="footer__link"
        href="https://github.com/CodeYourFuture/CYF-Workshops"
        ><svg
          focusable="false"
          role="presentation"
          viewBox="0 0 98 96"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M48.854.0C21.839.0.0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362.0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283.0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038.0.0 4.125-1.304 13.426 5.052a46.97 46.97.0 0112.214-1.63c4.125.0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2.0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126.0 6.6-.08 11.897-.08 13.526.0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788.0 48.854.0z"
            fill="currentcolor"
          ></path>
        </svg>
        <span class="is-invisible">Find us on GitHub</span></a
      >
    </footer>
    <script>
      class TeamRandomiser extends HTMLElement {
        constructor() {
          super();
          this.attachShadow({ mode: "open" });
          this.render();
        }

        style = `
        :host {
        width: 100%;}
        [type="number"], textarea, fieldset { 
            background: var(--paper);
            color: var(--ink);
            border: none; 
            padding: calc(var(--space) / 2);
            font-size: 1.375rem;
        }
        textarea { 
            width: 100%;
            width: -webkit-fill-available;
            min-height: 10rem;
            resize: vertical;
            box-shadow: 0 0 0 1px var(--ink);
        }
        label, legend {
        font-weight: 600;
        font-size: 1.2rem;
        padding:0
        }
        fieldset {
        padding: 0 0 var(--space) 0;}
        button {
        appearance: none;
        border:none;
        width: 100%;
        background: var(--ink);
        color: var(--paper);
        padding: calc(var(--space) / 2);
        text-transform: uppercase;
        font-size: 1.6rem;
        }
        button:hover, button:focus {
            background: var(--brand);
            color: var(--ink);
        }
    }
        `;

        render() {
          this.shadowRoot.innerHTML = `
                    <style>${this.style}</style>
                      <form id="teamForm">
                            <div>
                                <label for="names">Names:</label>
                                <textarea id="names" required placeholder="Enter names separated by commas or new lines" title="Enter names separated by commas or new lines"></textarea>
                            </div>
                            <div>
                                <label for="number">Number to group by:</label>
                                <input type="number" id="number" min="1" value="2">
                            </div>
                          <fieldset>
                              <legend>Group by</legend>
                              <label for="team-group">Number of teams </label>
                              <input id="team-group" type="radio" name="grouping" value="teams" checked>
                              <label for="people-group">Number of people in each team</label>
                              <input type="radio" name="grouping" value="people">
                             </fieldset>

                          <button type="submit">Get Teams</button>
                      </form>
                      <section id="result"></section>
                  `;

          this.shadowRoot
            .querySelector("#teamForm")
            .addEventListener("submit", this.handleSubmit.bind(this));
        }

        handleSubmit(e) {
          e.preventDefault();

          const names = this.shadowRoot
            .querySelector("#names")
            .value.split(/[\n,]+/)
            .map((name) => name.trim())
            .filter(Boolean);

          const number = parseInt(
            this.shadowRoot.querySelector("#number").value,
            10
          );
          const grouping = this.shadowRoot.querySelector(
            'input[name="grouping"]:checked'
          ).value;

          if (isNaN(number) || !names.length) return;

          const teams =
            grouping === "teams"
              ? this.distributeNames(names, number)
              : this.distributeNames(names, Math.ceil(names.length / number));

          this.displayTeams(teams);
        }

        distributeNames(names, groupCount) {
          names = [...names];
          const teams = Array.from({ length: groupCount }, () => []);

          while (names.length) {
            teams.forEach((team) => {
              if (names.length) {
                const randomIndex = Math.floor(Math.random() * names.length);
                team.push(names.splice(randomIndex, 1)[0]);
              }
            });
          }

          return teams;
        }

        displayTeams(teams) {
          this.shadowRoot.querySelector("#result").innerHTML = teams
            .map(
              (team, index) => `
          <section>
              <h3>Team ${index + 1}:</h3>
              <ul>
                  ${team.map((name) => `<li>${name}</li>`).join("")}
              </ul>
          </section>`
            )
            .join("");
        }
      }

      customElements.define("team-randomiser", TeamRandomiser);
    </script>
  </body>
</html>
